<!-- Modo Lista -->
<div [hidden]="edit" class="container-fluid pb-5">
  <!-- Buscar + botón agregar -->
  <div class="input-group my-3">
    <div class="input-group-prepend">
      <span class="input-group-text"><i class="fa fa-search"></i></span>
    </div>
    <input [(ngModel)]="searchField" (blur)="search()" (keydown)="keytab($event)"
           type="text" class="form-control" placeholder="Buscar {{ tituloSeccion | lowercase }}">
    <div class="input-group-append">
      <button class="btn btn-success" type="button" (click)="editRecord(null)">
        <i class="fa fa-plus-circle"></i>
      </button>
    </div>
  </div>

  <!-- Lista de páginas -->
  <div class="form-row">
    <div class="form-group col-12 col-sm-6" *ngFor="let pagina of Paginas; let i = index">
      <div class="card shadow-sm mb-3 hover-shadow-sm" (click)="editRecord(pagina)">
        <div class="card-body">
          <h5 class="card-title font-weight-bold">
            {{paginacion.FirstRow + i}} - {{pagina.Titulo}}
          </h5>
          <p class="mb-1 text-muted">
            URL: /{{pagina.Url_Amigable}}<br>
            Tipo: {{pagina.Es_Dinamica ? 'Dinámica' : 'Archivo'}}<br>
            Estado: 
            <span *ngIf="pagina.Activa" class="badge badge-info">Activa</span>
            <span *ngIf="!pagina.Activa" class="badge badge-secondary">Inactiva</span>
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- Paginación -->
  <div class="container-fluid">
    <ul class="pagination justify-content-center mt-3">
      <li class="page-item"><a (click)="ChangePage(0)" class="page-link"><i class="fa fa-fast-backward"></i></a></li>
      <li class="page-item"><a (click)="ChangePage(1)" class="page-link"><i class="fa fa-step-backward"></i></a></li>
      <li class="page-item"><a (click)="ChangePage(2)" class="page-link"><i class="fa fa-step-forward"></i></a></li>
    </ul>
  </div>
</div>

<!-- Modo Edición -->
<div [hidden]="!edit" class="container-fluid pb-5">
  <ul class="nav nav-tabs mb-3">
    <li class="nav-item">
      <a class="nav-link" [class.active]="GeneralActivo" (click)="activarGeneral()">General</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" [class.active]="SeccionesActivo" (click)="activarSecciones()">Secciones</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" [class.active]="SeoActivo" (click)="activarSeo()">SEO</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" [class.active]="MenuActivo" (click)="activarMenu()">Menú</a>
    </li>
  </ul>

  <!-- General -->
  <div *ngIf="GeneralActivo">
    <div class="form-group">
      <label>Título</label>
      <input class="form-control" [(ngModel)]="Pagina.Titulo">
    </div>
    <div class="form-group">
      <label>URL Amigable</label>
      <input class="form-control" [(ngModel)]="Pagina.Url_Amigable">
    </div>
    <div class="form-group">
      <label>¿Generada dinámicamente?</label>
      <select class="form-control" [(ngModel)]="Pagina.Es_Dinamica">
        <option [ngValue]="true">Sí, usar contenido CMS</option>
        <option [ngValue]="false">No, cargar archivo HTML</option>
      </select>
    </div>
    <div class="form-group" *ngIf="!Pagina.Es_Dinamica">
      <label>Ruta del archivo</label>
      <input class="form-control" [(ngModel)]="Pagina.Ruta_Estatica">
    </div>
    <div class="form-group">
      <label>Activa</label>
      <input type="checkbox" [(ngModel)]="Pagina.Activa">
    </div>
  </div>

  <!-- Secciones -->
  <div *ngIf="SeccionesActivo">
    <app-cms-secciones [IdPagina]="Pagina.Id_Pagina" *ngIf="Pagina.Id_Pagina"></app-cms-secciones>
  </div>

  <!-- SEO -->
  <div *ngIf="SeoActivo">
    <div class="form-group">
      <label>Meta Descripción</label>
      <textarea class="form-control" [(ngModel)]="Pagina.Meta_Descripcion" rows="2"></textarea>
    </div>
    <div class="form-group">
      <label>Meta Keywords</label>
      <input class="form-control" [(ngModel)]="Pagina.Meta_Keywords">
    </div>
  </div>

  <!-- Menú -->
  <div *ngIf="MenuActivo">
    <div class="form-group">
      <label>¿Mostrar en menú?</label>
      <input type="checkbox" [(ngModel)]="Pagina.Mostrar_En_Menu">
    </div>

    <div class="form-row">
      <div class="form-group col-md-6">
        <label>Etiqueta del menú</label>
        <input class="form-control" [(ngModel)]="Pagina.Etiqueta_Menu" placeholder="Texto visible en el menú">
      </div>

      <div class="form-group col-md-6">
        <label>Ícono (FontAwesome)</label>
        <input class="form-control" [(ngModel)]="Pagina.Icono_Menu" placeholder="fas fa-globe">
      </div>
    </div>

    <div class="form-row">
      <div class="form-group col-md-6">
        <label>Ruta del componente (opcional)</label>
        <input class="form-control" [(ngModel)]="Pagina.Ruta">
      </div>

      <div class="form-group col-md-6">
        <label>Orden de aparición</label>
        <input class="form-control" type="number" [(ngModel)]="Pagina.Orden_Menu">
      </div>
    </div>

    <div class="form-group">
      <label>Menú padre</label>
      <select class="form-control" [(ngModel)]="Pagina.Menu_Padre">
        <option [ngValue]="null">Ninguno (nivel principal)</option>
        <option *ngFor="let p of PaginasMenuPadre" [ngValue]="p.Id_Pagina">
          {{ p.Etiqueta_Menu || p.Titulo }}
        </option>
      </select>
    </div>
  </div>

  <!-- Botones -->
  <div class="form-row mt-4">
    <div class="form-group col-md-12">
      <div class="form-row">
        <div class="form-group col-6 col-md-8"></div>
        <div class="form-group col-3 col-md-2">
          <button (click)="grabar()" type="button" class="btn btn-success">Grabar</button>
        </div>
        <div class="form-group col-3 col-md-2">
          <button (click)="cancel()" type="button" class="btn btn-danger">Cancelar</button>
        </div>
      </div>
    </div>
  </div>
</div>